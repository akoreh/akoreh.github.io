import{a as _e,b as Fe,f as ye}from"./chunk-5RVANUM6.js";import{d as Ae,j as xe,k as je}from"./chunk-NJPGD756.js";import{$a as pe,E as W,G,H as Ie,J as Ne,L as de,Oa as Oe,P as X,S as Y,T as P,X as p,Y as le,_ as g,a as c,aa as k,b as v,ba as l,ca as q,dc as H,ea as ue,fa as De,fb as me,h as Pe,j as ke,la as Se,ma as fe,p as ae,q as K,sa as Z,ta as he,u as ce,v as z,va as Q}from"./chunk-G7STBN2K.js";var N=class r{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let o=t.slice(0,n),i=t.slice(n+1).trim();this.addHeaderEntry(o,i)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.addHeaderEntry(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new r;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let o=(e.op==="a"?this.headers.get(t):void 0)||[];o.push(...n),this.headers.set(t,o);break;case"d":let i=e.value;if(!i)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(d=>i.indexOf(d)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let n=e.toLowerCase();this.maybeSetNormalizedName(e,n),this.headers.has(n)?this.headers.get(n).push(t):this.headers.set(n,[t])}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(i=>i.toString()),o=e.toLowerCase();this.headers.set(o,n),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var te=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}},re=class{encodeKey(e){return Ce(e)}encodeValue(e){return Ce(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function ct(r,e){let t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(o=>{let i=o.indexOf("="),[s,d]=i==-1?[e.decodeKey(o),""]:[e.decodeKey(o.slice(0,i)),e.decodeValue(o.slice(i+1))],a=t.get(s)||[];a.push(d),t.set(s,a)}),t}var dt=/%(\d[a-f0-9])/gi,lt={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ce(r){return encodeURIComponent(r).replace(dt,(e,t)=>lt[t]??e)}function ee(r){return`${r}`}var R=class r{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new re,e.fromString){if(e.fromObject)throw new P(2805,!1);this.map=ct(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],o=Array.isArray(n)?n.map(ee):[ee(n)];this.map.set(t,o)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let o=e[n];Array.isArray(o)?o.forEach(i=>{t.push({param:n,value:i,op:"a"})}):t.push({param:n,value:o,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new r({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(ee(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],o=n.indexOf(ee(e.value));o!==-1&&n.splice(o,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};function ut(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Le(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Ue(r){return typeof Blob<"u"&&r instanceof Blob}function Be(r){return typeof FormData<"u"&&r instanceof FormData}function ft(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Je="Content-Type",Ke="Accept",Xe="text/plain",$e="application/json",ht=`${$e}, ${Xe}, */*`,_=class r{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,n,o){this.url=t,this.method=e.toUpperCase();let i;if(ut(this.method)||o?(this.body=n!==void 0?n:null,i=o):i=n,i){if(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,this.keepalive=!!i.keepalive,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),i.priority&&(this.priority=i.priority),i.cache&&(this.cache=i.cache),i.credentials&&(this.credentials=i.credentials),typeof i.timeout=="number"){if(i.timeout<1||!Number.isInteger(i.timeout))throw new P(2822,"");this.timeout=i.timeout}i.mode&&(this.mode=i.mode),i.redirect&&(this.redirect=i.redirect),i.integrity&&(this.integrity=i.integrity),i.referrer&&(this.referrer=i.referrer),i.referrerPolicy&&(this.referrerPolicy=i.referrerPolicy),this.transferCache=i.transferCache}if(this.headers??=new N,this.context??=new te,!this.params)this.params=new R,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let d=t.indexOf("?"),a=d===-1?"?":d<t.length-1?"&":"";this.urlWithParams=t+a+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Le(this.body)||Ue(this.body)||Be(this.body)||ft(this.body)?this.body:this.body instanceof R?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Be(this.body)?null:Ue(this.body)?this.body.type||null:Le(this.body)?null:typeof this.body=="string"?Xe:this.body instanceof R?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?$e:null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,o=e.responseType||this.responseType,i=e.keepalive??this.keepalive,s=e.priority||this.priority,d=e.cache||this.cache,a=e.mode||this.mode,y=e.redirect||this.redirect,x=e.credentials||this.credentials,E=e.referrer||this.referrer,M=e.integrity||this.integrity,D=e.referrerPolicy||this.referrerPolicy,S=e.transferCache??this.transferCache,b=e.timeout??this.timeout,u=e.body!==void 0?e.body:this.body,f=e.withCredentials??this.withCredentials,w=e.reportProgress??this.reportProgress,j=e.headers||this.headers,h=e.params||this.params,B=e.context??this.context;return e.setHeaders!==void 0&&(j=Object.keys(e.setHeaders).reduce((J,O)=>J.set(O,e.setHeaders[O]),j)),e.setParams&&(h=Object.keys(e.setParams).reduce((J,O)=>J.set(O,e.setParams[O]),h)),new r(t,n,u,{params:h,headers:j,context:B,reportProgress:w,responseType:o,withCredentials:f,transferCache:S,keepalive:i,cache:d,priority:s,timeout:b,mode:a,redirect:y,credentials:x,referrer:E,integrity:M,referrerPolicy:D})}},A=(function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r})(A||{}),F=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,n="OK"){this.headers=e.headers||new N,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}},ne=class r extends F{constructor(e={}){super(e)}type=A.ResponseHeader;clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},$=class r extends F{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=A.Response;clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}},I=class extends F{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},pt=200,mt=204;var yt=new g("");var gt=/^\)\]\}',?\n/;var Te=(()=>{class r{xhrFactory;tracingService=l(Oe,{optional:!0});constructor(t){this.xhrFactory=t}maybePropagateTrace(t){return this.tracingService?.propagate?this.tracingService.propagate(t):t}handle(t){if(t.method==="JSONP")throw new P(-2800,!1);let n=this.xhrFactory;return ae(null).pipe(X(()=>new Pe(i=>{let s=n.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((u,f)=>s.setRequestHeader(u,f.join(","))),t.headers.has(Ke)||s.setRequestHeader(Ke,ht),!t.headers.has(Je)){let u=t.detectContentTypeHeader();u!==null&&s.setRequestHeader(Je,u)}if(t.timeout&&(s.timeout=t.timeout),t.responseType){let u=t.responseType.toLowerCase();s.responseType=u!=="json"?u:"text"}let d=t.serializeBody(),a=null,y=()=>{if(a!==null)return a;let u=s.statusText||"OK",f=new N(s.getAllResponseHeaders()),w=s.responseURL||t.url;return a=new ne({headers:f,status:s.status,statusText:u,url:w}),a},x=this.maybePropagateTrace(()=>{let{headers:u,status:f,statusText:w,url:j}=y(),h=null;f!==mt&&(h=typeof s.response>"u"?s.responseText:s.response),f===0&&(f=h?pt:0);let B=f>=200&&f<300;if(t.responseType==="json"&&typeof h=="string"){let J=h;h=h.replace(gt,"");try{h=h!==""?JSON.parse(h):null}catch(O){h=J,B&&(B=!1,h={error:O,text:h})}}B?(i.next(new $({body:h,headers:u,status:f,statusText:w,url:j||void 0})),i.complete()):i.error(new I({error:h,headers:u,status:f,statusText:w,url:j||void 0}))}),E=this.maybePropagateTrace(u=>{let{url:f}=y(),w=new I({error:u,status:s.status||0,statusText:s.statusText||"Unknown Error",url:f||void 0});i.error(w)}),M=E;t.timeout&&(M=this.maybePropagateTrace(u=>{let{url:f}=y(),w=new I({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:f||void 0});i.error(w)}));let D=!1,S=this.maybePropagateTrace(u=>{D||(i.next(y()),D=!0);let f={type:A.DownloadProgress,loaded:u.loaded};u.lengthComputable&&(f.total=u.total),t.responseType==="text"&&s.responseText&&(f.partialText=s.responseText),i.next(f)}),b=this.maybePropagateTrace(u=>{let f={type:A.UploadProgress,loaded:u.loaded};u.lengthComputable&&(f.total=u.total),i.next(f)});return s.addEventListener("load",x),s.addEventListener("error",E),s.addEventListener("timeout",M),s.addEventListener("abort",E),t.reportProgress&&(s.addEventListener("progress",S),d!==null&&s.upload&&s.upload.addEventListener("progress",b)),s.send(d),i.next({type:A.Sent}),()=>{s.removeEventListener("error",E),s.removeEventListener("abort",E),s.removeEventListener("load",x),s.removeEventListener("timeout",M),t.reportProgress&&(s.removeEventListener("progress",S),d!==null&&s.upload&&s.upload.removeEventListener("progress",b)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(n){return new(n||r)(k(je))};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Ve(r,e){return e(r)}function Tt(r,e){return(t,n)=>e.intercept(t,{handle:o=>r(o,n)})}function vt(r,e,t){return(n,o)=>De(t,()=>e(n,i=>r(i,o)))}var L=new g(""),ve=new g("",{factory:()=>[]}),We=new g(""),we=new g("",{factory:()=>!0});function wt(){let r=null;return(e,t)=>{r===null&&(r=(l(L,{optional:!0})??[]).reduceRight(Tt,Ve));let n=l(he);if(l(we)){let i=n.add();return r(e,t).pipe(de(i))}else return r(e,t)}}var Ee=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:function(n){let o=null;return n?o=new(n||r):o=k(Te),o},providedIn:"root"})}return r})();var oe=(()=>{class r{backend;injector;chain=null;pendingTasks=l(he);contributeToStability=l(we);constructor(t,n){this.backend=t,this.injector=n}handle(t){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(ve),...this.injector.get(We,[])]));this.chain=n.reduceRight((o,i)=>vt(o,i,this.injector),Ve)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(t,o=>this.backend.handle(o)).pipe(de(n))}else return this.chain(t,n=>this.backend.handle(n))}static \u0275fac=function(n){return new(n||r)(k(Ee),k(ue))};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),be=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:function(n){let o=null;return n?o=new(n||r):o=k(oe),o},providedIn:"root"})}return r})();function ge(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,credentials:r.credentials,transferCache:r.transferCache,timeout:r.timeout,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,integrity:r.integrity,referrer:r.referrer,referrerPolicy:r.referrerPolicy}}var ie=(()=>{class r{handler;constructor(t){this.handler=t}request(t,n,o={}){let i;if(t instanceof _)i=t;else{let a;o.headers instanceof N?a=o.headers:a=new N(o.headers);let y;o.params&&(o.params instanceof R?y=o.params:y=new R({fromObject:o.params})),i=new _(t,n,o.body!==void 0?o.body:null,{headers:a,context:o.context,params:y,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache,keepalive:o.keepalive,priority:o.priority,cache:o.cache,mode:o.mode,redirect:o.redirect,credentials:o.credentials,referrer:o.referrer,referrerPolicy:o.referrerPolicy,integrity:o.integrity,timeout:o.timeout})}let s=ae(i).pipe(Ie(a=>this.handler.handle(a)));if(t instanceof _||o.observe==="events")return s;let d=s.pipe(W(a=>a instanceof $));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return d.pipe(z(a=>{if(a.body!==null&&!(a.body instanceof ArrayBuffer))throw new P(2806,!1);return a.body}));case"blob":return d.pipe(z(a=>{if(a.body!==null&&!(a.body instanceof Blob))throw new P(2807,!1);return a.body}));case"text":return d.pipe(z(a=>{if(a.body!==null&&typeof a.body!="string")throw new P(2808,!1);return a.body}));case"json":default:return d.pipe(z(a=>a.body))}case"response":return d;default:throw new P(2809,!1)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:new R().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,o={}){return this.request("PATCH",t,ge(o,n))}post(t,n,o={}){return this.request("POST",t,ge(o,n))}put(t,n,o={}){return this.request("PUT",t,ge(o,n))}static \u0275fac=function(n){return new(n||r)(k(be))};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Et=new g("",{factory:()=>!0}),bt="XSRF-TOKEN",Rt=new g("",{factory:()=>bt}),Mt="X-XSRF-TOKEN",Pt=new g("",{providedIn:"root",factory:()=>Mt}),kt=(()=>{class r{cookieName=l(Rt);doc=l(Se);lastCookieString="";lastToken=null;parseCount=0;getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=xe(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ge=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:function(n){let o=null;return n?o=new(n||r):o=k(kt),o},providedIn:"root"})}return r})();function It(r,e){if(!l(Et)||r.method==="GET"||r.method==="HEAD")return e(r);try{let o=l(Ae).href,{origin:i}=new URL(o),{origin:s}=new URL(r.url,i);if(i!==s)return e(r)}catch{return e(r)}let t=l(Ge).getToken(),n=l(Pt);return t!=null&&!r.headers.has(n)&&(r=r.clone({headers:r.headers.set(n,t)})),e(r)}var Re=(function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r})(Re||{});function Nt(r,e){return{\u0275kind:r,\u0275providers:e}}function Dt(...r){let e=[ie,oe,{provide:be,useExisting:oe},{provide:Ee,useFactory:()=>l(yt,{optional:!0})??l(Te)},{provide:ve,useValue:It,multi:!0}];for(let t of r)e.push(...t.\u0275providers);return q(e)}var ze=new g("");function St(){return Nt(Re.LegacyInterceptors,[{provide:ze,useFactory:wt},{provide:ve,useExisting:ze,multi:!0}])}var Ye={api:"https://api.akoreh.com/api/v1"};var U=new g("ENVIRONMENT");function Pr(){return{provide:U,useValue:Ye}}var qe=Symbol("");function Ze(r){return new Proxy(r,{has(e,t){return!!this.get(e,t,void 0)},get(e,t){let n=Q(e);return!At(n)||!(t in n)?(me(e[t])&&e[t][qe]&&delete e[t],e[t]):(me(e[t])||(Object.defineProperty(e,t,{value:H(()=>e()[t]),configurable:!0}),e[t][qe]=!0),Ze(e[t]))}})}var Ot=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function At(r){if(r===null||typeof r!="object"||xt(r))return!1;let e=Object.getPrototypeOf(r);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(Ot.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function xt(r){return typeof r?.[Symbol.iterator]=="function"}var jt=new WeakMap,m=Symbol("");function T(r,...e){let t=Q(()=>Qe(r)),n=e.reduce((s,d)=>c(c({},s),typeof d=="function"?d(s):d),t),o=r[m],i=Reflect.ownKeys(r[m]);for(let s of Reflect.ownKeys(n))if(i.includes(s)){let d=s;t[d]!==n[d]&&o[d].set(n[d])}Ft(r)}function Qe(r){let e=r[m];return Reflect.ownKeys(r[m]).reduce((t,n)=>{let o=e[n]();return v(c({},t),{[n]:o})},{})}function _t(r){return jt.get(r[m])||[]}function Ft(r){let e=_t(r);for(let t of e){let n=Q(()=>Qe(r));t(n)}}function He(...r){let e=[...r],t=typeof e[0]=="function"?{}:e.shift(),n=e;return(()=>{class i{constructor(){let d=n.reduce((b,u)=>u(b),Ct()),{stateSignals:a,props:y,methods:x,hooks:E}=d,M=c(c(c({},a),y),x);this[m]=d[m];for(let b of Reflect.ownKeys(M))this[b]=M[b];let{onInit:D,onDestroy:S}=E;D&&D(),S&&l(fe).onDestroy(S)}static \u0275fac=function(a){return new(a||i)};static \u0275prov=p({token:i,factory:i.\u0275fac,providedIn:t.providedIn||null})}return i})()}function Ct(){return{[m]:{},stateSignals:{},props:{},methods:{},hooks:{}}}function et(r){return e=>{let t=r(c(c(c({[m]:e[m]},e.stateSignals),e.props),e.methods));return v(c({},e),{props:c(c({},e.props),t)})}}function tt(r){return e=>{let t=c(c(c({[m]:e[m]},e.stateSignals),e.props),e.methods),n=typeof r=="function"?r(t):r,o=(i,s)=>s?()=>{i&&i(),s(t)}:i;return v(c({},e),{hooks:{onInit:o(e.hooks.onInit,n.onInit),onDestroy:o(e.hooks.onDestroy,n.onDestroy)}})}}function rt(r){return e=>{let t=r(c(c(c({[m]:e[m]},e.stateSignals),e.props),e.methods));return v(c({},e),{methods:c(c({},e.methods),t)})}}function nt(r){return e=>{let t=typeof r=="function"?r():r,n=Reflect.ownKeys(t),o=e[m],i={};for(let s of n)o[s]=Z(t[s]),i[s]=Ze(o[s]);return v(c({},e),{stateSignals:c(c({},e.stateSignals),i)})}}var ot=(()=>{class r{notificationsSignal=Z([]);notifications=H(()=>this.notificationsSignal());show(t,n={}){let o=this.generateId(),i={id:o,message:t,type:n.type??"default",title:n.title,icon:n.icon};return this.notificationsSignal.update(s=>[i,...s]),o}showDefault(t,n={}){return this.show(t,v(c({},n),{type:"default"}))}showError(t,n={}){return this.show(t,v(c({},n),{type:"error"}))}dismiss(t){this.notificationsSignal.update(n=>n.filter(o=>o.id!==t))}dismissAll(){this.notificationsSignal.set([])}generateId(){return`notification-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var it=(()=>{class r{get(t){let n=window.localStorage.getItem(t);if(n)return this.isStringifiedJson(n)?JSON.parse(n):n}set(t,n){if(_e(n)){let o=JSON.stringify(n);window.localStorage.setItem(t,o)}else window.localStorage.setItem(t,n)}remove(t){window.localStorage.removeItem(t)}isStringifiedJson(t){if(typeof t!="string")return!1;try{let n=JSON.parse(t);return Object.prototype.toString.call(n)==="[object Object]"}catch(n){return Fe(n),!1}}static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var V=(()=>{class r{http=l(ie);localStorageService=l(it);environment=l(U);get url(){return`${this.environment.api}/auth`}storageKeys={accessToken:"accessToken",refreshToken:"refreshToken"};login(t){return ce(this.http.post(`${this.url}/login`,t).pipe(Y(n=>this.storeTokens(n))))}register(t){return ce(this.http.post(`${this.url}/register`,t).pipe(Y(n=>this.storeTokens(n))))}logout(){this.localStorageService.remove(this.storageKeys.accessToken),this.localStorageService.remove(this.storageKeys.refreshToken)}getAccessToken(){return this.localStorageService.get(this.storageKeys.accessToken)||null}getRefreshToken(){return this.localStorageService.get(this.storageKeys.refreshToken)||null}refreshAccessToken(){let t=this.getRefreshToken();return this.http.post(`${this.url}/refresh`,{refreshToken:t}).pipe(Y(n=>this.storeTokens(n)))}decodeJWT(t){try{let n=t.split(".");if(n.length!==3)throw new Error("Invalid JWT token format");let o=n[1],i=o+"===".slice((o.length+3)%4),s=atob(i);return JSON.parse(s)}catch(n){throw new Error(`Failed to decode JWT token: ${n instanceof Error?n.message:"Unknown error"}`)}}isJWTExpired(t){try{let n=this.decodeJWT(t);return n.exp?Date.now()>=n.exp*1e3:!1}catch{return!0}}storeTokens({accessToken:t,refreshToken:n}){this.localStorageService.set(this.storageKeys.accessToken,t),this.localStorageService.set(this.storageKeys.refreshToken,n)}static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Lt="Something went wrong. Please try again.";function st(r){if(r instanceof I){let e=r.error;if(e?.errorMessage)return e.errorMessage}return Lt}var at={accessToken:null,refreshToken:null,userId:null,email:null,roles:[],isAuthenticated:!1,isLoading:!1,error:null},Me=He({providedIn:"root"},nt(at),et(()=>({authService:l(V),notificationService:l(ot)})),rt(r=>({setAccessToken(e){try{let t=r.authService.decodeJWT(e);T(r,{accessToken:e,userId:t.userId,email:t.email,roles:t.roles??[],isAuthenticated:!ye(e)})}catch{T(r,{accessToken:e,roles:[],isAuthenticated:!ye(e)})}},setRefreshToken(e){T(r,t=>v(c({},t),{refreshToken:e}))},async login(e){T(r,{isLoading:!0,error:null});try{let{accessToken:t,refreshToken:n,user:o}=await r.authService.login(e);T(r,{accessToken:t,refreshToken:n,userId:o.id,email:o.email,roles:o.roles??[],isAuthenticated:!0,isLoading:!1}),r.notificationService.show(`Welcome back, ${o.email}!`,{title:"Signed In",icon:"key"})}catch(t){let n=st(t);T(r,{isLoading:!1,error:n})}},async register(e){T(r,{isLoading:!0,error:null});try{let{accessToken:t,refreshToken:n,user:o}=await r.authService.register(e);T(r,{accessToken:t,refreshToken:n,userId:o.id,email:o.email,roles:o.roles??[],isAuthenticated:!0,isLoading:!1})}catch(t){let n=st(t);T(r,{isLoading:!1,error:n})}},clearError(){T(r,{error:null})},logout(){r.authService.logout(),T(r,at)}})),tt({onInit(r){let e=l(V),t=e.getAccessToken(),n=e.getRefreshToken();t&&r.setAccessToken(t),n&&r.setRefreshToken(n)}}));var se=(()=>{class r{authService=l(V);authStore=l(Me);environment=l(U);isRefreshing=!1;refreshTokenSubject=new ke(null);intercept(t,n){if(!t.url.startsWith(this.environment.api))return n.handle(t);let o=this.addTokenToRequest(t);return n.handle(o).pipe(G(i=>i.status===401&&!t.url.includes("/auth/")?this.handle401Error(t,n):K(()=>i)))}handle401Error(t,n){return this.isRefreshing?this.refreshTokenSubject.pipe(W(o=>o!==null),Ne(1),X(o=>n.handle(this.addTokenToRequest(t,o)))):(this.isRefreshing=!0,this.refreshTokenSubject.next(null),this.authService.getRefreshToken()?this.authService.refreshAccessToken().pipe(G(i=>(this.isRefreshing=!1,this.authStore.logout(),K(()=>i))),X(({accessToken:i})=>(this.isRefreshing=!1,this.refreshTokenSubject.next(i),this.authStore.setAccessToken(i),n.handle(this.addTokenToRequest(t,i)).pipe(G(s=>(s.status===401&&this.authStore.logout(),K(()=>s))))))):(this.isRefreshing=!1,this.authStore.logout(),K(()=>new Error("No refresh token available"))))}addTokenToRequest(t,n){let o=n??this.authService.getAccessToken();return o?t.clone({setHeaders:{Authorization:`Bearer ${o}`}}):t}static \u0275fac=function(n){return new(n||r)};static \u0275prov=p({token:r,factory:r.\u0275fac})}return r})();function Ut(){return q([{provide:L,useClass:se,multi:!0}])}var Bt=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=pe({type:r});static \u0275inj=le({providers:[{provide:L,useClass:se,multi:!0}]})}return r})();export{ie as a,Dt as b,St as c,T as d,He as e,rt as f,nt as g,it as h,U as i,Pr as j,ot as k,Me as l,Ut as m,Bt as n};
